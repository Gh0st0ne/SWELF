#Layout of Searchs.txt File for searching:
#SearchTerm~EventLogName~EventID

#windows-bits
VsBitsDownloadJob~microsoft-windows-bits-client/operational~

#Windows Powershell
webclient~windows powershell~
iex~windows powershell~
wscript~windows powershell~
New-Service~windows powershell~
schtask~windows powershell~
task~windows powershell~
count:|:2~windows powershell~
hidden~windows powershell~

#AMSI
~AMSI/Operational~

#Microsoft-Windows-Security-Mitigations/KernelMode
~Microsoft-Windows-Security-Mitigations/KernelMode~

#Windows-PowerShell/Operational
count:-join:2~Microsoft-Windows-PowerShell/Operational~
count:':30~Microsoft-Windows-PowerShell/Operational~
count:+:5~Microsoft-Windows-PowerShell/Operational~
count:;:12~Microsoft-Windows-PowerShell/Operational~
count:|:2~Microsoft-Windows-PowerShell/Operational~
iwr('http~Microsoft-Windows-PowerShell/Operational~
eventdata_length:10000~Microsoft-Windows-PowerShell/Operational~
webclient~Microsoft-Windows-PowerShell/Operational~
iex~Microsoft-Windows-PowerShell/Operational~
wscript~Microsoft-Windows-PowerShell/Operational~
powershell New-Service~Microsoft-Windows-PowerShell/Operational~
$env~Microsoft-Windows-PowerShell/Operational~
http~Microsoft-Windows-PowerShell/Operational~
base64decode~Microsoft-Windows-PowerShell/Operational~
|iex~Microsoft-Windows-PowerShell/Operational~
count:&:10~Microsoft-Windows-PowerShell/Operational~
frombase64string~Microsoft-Windows-PowerShell/Operational~

#Application
~Application~866
~Application~1534

#WMI~Application


#Windows-Sysmon/Operational
~Microsoft-Windows-Sysmon/Operational~2
~Microsoft-Windows-Sysmon/Operational~8
~Microsoft-Windows-Sysmon/Operational~9
~Microsoft-Windows-Sysmon/Operational~10
~Microsoft-Windows-Sysmon/Operational~12
~Microsoft-Windows-Sysmon/Operational~17
~Microsoft-Windows-Sysmon/Operational~18
~Microsoft-Windows-Sysmon/Operational~19
~Microsoft-Windows-Sysmon/Operational~20
~Microsoft-Windows-Sysmon/Operational~21
mshta.exe javascript:~Microsoft-Windows-Sysmon/Operational~
mshta vbscript:~Microsoft-Windows-Sysmon/Operational~
regsvr32.exe /s /u /i:~Microsoft-Windows-Sysmon/Operational~
bitsadmin.exe  /transfer~Microsoft-Windows-Sysmon/Operational~
bitsadmin.exe /download~Microsoft-Windows-Sysmon/Operational~ 
rundll32.exe javascript:~Microsoft-Windows-Sysmon/Operational~
count:;:2~Microsoft-Windows-Sysmon/Operational~
Signed: false~Microsoft-Windows-Sysmon/Operational~6
commandline_contains:msiexec /q /i~Microsoft-Windows-Sysmon/Operational~
commandline_contains:msiexec /quiet /i~Microsoft-Windows-Sysmon/Operational~
commandline_contains:mshta -Enbedding~Microsoft-Windows-Sysmon/Operational~
commandline_contains:mshta javascript~Microsoft-Windows-Sysmon/Operational~
commandline_contains:rundll32.exe javascript~Microsoft-Windows-Sysmon/Operational~
commandline_contains:ATBroker /start~Microsoft-Windows-Sysmon/Operational~
commandline_contains:ATBroker.exe /start~Microsoft-Windows-Sysmon/Operational~
commandline_contains:EQNEDT32.EXE -Embedding~Microsoft-Windows-Sysmon/Operational~
commandline_contains:pcalua.exe -a~Microsoft-Windows-Sysmon/Operational~
commandline_contains:regasm.exe /U~Microsoft-Windows-Sysmon/Operational~
count:|:2~Microsoft-Windows-Sysmon/Operational~
#commandline_contains:C:\Windows\System32\wmiprvse.exe -secured -Embedding~Microsoft-Windows-Sysmon/Operational~1

#Defender
detected~microsoft-Windows-Windows Defender/Operational~
detection~microsoft-Windows-Windows Defender/Operational~ 
malware~microsoft-Windows-Windows Defender/Operational~
disabled~microsoft-Windows-Windows Defender/Operational~
windows defender antivirus configuration has changed.~microsoft-Windows-Windows Defender/Operational~
~microsoft-Windows-Windows Defender/Operational~1123
~microsoft-Windows-Windows Defender/Operational~5007
windows defender antivirus scanning for spyware and other potentially unwanted software is disabled.~microsoft-Windows-Windows Defender/Operational~
~microsoft-Windows-Windows Defender/Operational~1007
~microsoft-Windows-Windows Defender/Operational~1008
~microsoft-Windows-Windows Defender/Operational~1015
~microsoft-Windows-Windows Defender/Operational~1116
~microsoft-Windows-Windows Defender/Operational~1117
~microsoft-Windows-Windows Defender/Operational~3007
#~microsoft-Windows-Windows Defender/Operational~5001
#~microsoft-Windows-Windows Defender/Operational~5007

#DistributedCOM
Microsoft-Windows-DistributedCOM~System~10016

#RemoteConnectionManager/Operational
~Microsoft-Windows-TerminalServices-RemoteConnectionManager~1056
~Microsoft-Windows-TerminalServices-RemoteConnectionManager~1149

#Microsoft-Windows-TerminalServices-LocalSessionManager/Operational
#~Microsoft-Windows-TerminalServices-LocalSessionManager~21
#~Microsoft-Windows-TerminalServices-LocalSessionManager~23
#~Microsoft-Windows-TerminalServices-LocalSessionManager~24
#~Microsoft-Windows-TerminalServices-LocalSessionManager~25

#Microsoft-WindowsCodeIntegrity/Operational
~Microsoft-WindowsCodeIntegrity/Operational~3033

#System
~System~104
~System~7045
~System~7040
~System~7022
~System~4719

#Security
~Security~517
~Security~1100
~Security~1101
~Security~1102 
~Security~1108
~Security~7045 
~Security~5140
~Security~4672
~Security~4720 
#~Security~4688
Logon Type:		9~Security~4624 
Logon Type:		3~Security~4624 
Logon Type:		10~Security~4624

#Microsoft-Windows-TaskScheduler/Operational
~Microsoft-Windows-TaskScheduler/Operational~106
~Microsoft-Windows-TaskScheduler/Operational~141

#DNS-Client
~Microsoft-Windows-DNS-Client~System~1014

#Commands COMMANDLINES to be run on all
commandline_length:300
commandline_contains:<
commandline_contains:>
commandline_contains:$env
commandline_contains:print /D:
commandline_contains:expand
commandline_contains:cmstp.exe /ni /s
commandline_contains:odbcconf -f
commandline_contains:-windowstyle hidden
commandline_contains:runscripthelper.exe surfacecheck
commandline_contains:Scriptrunner.exe -appvscript
commandline_contains:javascript
commandline_contains:vbscript
commandline_contains:sc create

#Command COUNT to be run on all
count:+:12
count:&:10
count:-split:3
count:^:9
count:`:9
count:call:4
count:set:5
count:-join:5

#KEYWORD SEARCHS to be run on all
jscript.exe
cvtres.exe
vbscript.exe
csript.exe
cmstp.exe
Iexpress.exe
psr.exe
CMSTP.exe
expand.exe
control.exe
ieexec.exe
makecab.exe
extrac.exe
ftp.exe
mshta
.bgi
rundll32.exe javascript:
rundll32.exe http:
.SettingContent-ms
